const request = require('request');

module.exports = async client => {
  const statusList = [
    {msg: `[.] play.infestedmc.com`, type: 'PLAYING'},
  ];

  setInterval(async () => {
    let index = Math.floor(Math.random() * statusList.length + 1) - 1;
    await client.user.setActivity(statusList[index].msg, {
      type: statusList[index].type
    });
  }, 5000);
  
  setInterval(async () => {
    request('https://web.cytrus.ga', (err, res, html) => {
      if (err) client.logger.error(err);
    });
  }, 28000);

  client.user.setStatus('idle');

  //Logs the Status
  client.logger.log(`Ram Usage: ${(process.memoryUsage().heapUsed / 1024 / 1024).toFixed(2)}MB`, 'ready');
  client.logger.log(`Users: ${client.users.size.toLocaleString().replace(/ /g, '')}`, 'ready');
  client.logger.log(`Servers: ${client.guilds.size.toLocaleString().replace(/ /g, '')}`, 'ready');
  client.logger.log(`Channels: ${client.channels.size.toLocaleString().replace(/ /g, '')}`, 'ready');
  client.logger.log(`Discord.js: v${require('discord.js').version.replace(/ /g, '')}`, 'ready');
  client.logger.log(`Node.js: ${process.version.replace(/ /g, '')}`, 'ready');

  //Starts the web server/API
//  require('../modules/web')(client);

  client.logger.log('Infested' + require('../package').version + ' | ');
  client.startuptime = new Date().getTime() - client.starttime;
  client.logger.log('It took ' + client.startuptime + 'ms to start Infested Bot');
};
